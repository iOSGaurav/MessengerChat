
iOS WCAG Accessibility Auditor MCP Tool

(AI-Enhanced + Snapshot Diffing + VoiceOver Evidence + ZIP Output)

You are a Principal iOS Accessibility Engineer, XCUITest/Appium Automation Architect, WCAG 2.2 AA Auditor, AI Remediation Specialist, and MCP (Model Context Protocol) Tooling Expert.

Your task is to DESIGN AND IMPLEMENT a production-ready MCP tool written in Python 3.10+ that performs fully automated accessibility testing for iOS applications, validates against WCAG 2.2 (A & AA) and iOS accessibility best practices, captures evidence artifacts, supports snapshot-based UI diffing, includes Partial Blind Accessibility analysis, and provides a dedicated VoiceOver Evidence Mode.

The final output MUST be packaged as a single downloadable ZIP containing all source code, documentation, examples, and sample artifacts.

This is a standalone, non-SaaS, automation-first tool designed to run locally or in CI/CD.

‚∏ª

1Ô∏è‚É£ TOOL IDENTITY
	‚Ä¢	Tool Name: ios_wcag_accessibility_auditor
	‚Ä¢	Tool Type: MCP Python Tool
	‚Ä¢	Platform: iOS ONLY
	‚Ä¢	Python: 3.10+

Core Technologies
	‚Ä¢	Appium
	‚Ä¢	XCUITest
	‚Ä¢	WebDriverAgent (WDA)
	‚Ä¢	MCP Server Protocol
	‚Ä¢	Optional LLM / AI plugin layer
	‚Ä¢	Snapshot diffing engine (UI tree + screenshots)

‚∏ª

2Ô∏è‚É£ NON-NEGOTIABLE REQUIREMENTS

MUST
	‚Ä¢	Real Appium + XCUITest sessions
	‚Ä¢	Automatic app launch and traversal
	‚Ä¢	Deterministic WCAG rule engine
	‚Ä¢	Evidence capture (screenshots, page source, element metadata)
	‚Ä¢	Optional AI (advisor only)
	‚Ä¢	Snapshot-based diffing between runs
	‚Ä¢	Partial Blind Accessibility analysis
	‚Ä¢	VoiceOver Evidence Mode
	‚Ä¢	JSON + HTML + optional PDF reports
	‚Ä¢	CI-friendly execution
	‚Ä¢	Final ZIP output

MUST NOT
	‚Ä¢	No Android
	‚Ä¢	No SaaS
	‚Ä¢	No fake data
	‚Ä¢	No AI-only compliance decisions
	‚Ä¢	No missing files

‚∏ª

3Ô∏è‚É£ MCP CONTRACT (MANDATORY)

Implement an MCP server exposing these tools:

validate_environment() -> dict

Checks:
	‚Ä¢	Appium reachable
	‚Ä¢	Xcode CLI tools available (xcrun)
	‚Ä¢	iOS simulators available
	‚Ä¢	WDA readiness hints (best-effort)
Return actionable diagnostics and remediation tips.

list_targets() -> dict

Returns:
	‚Ä¢	Available simulators
	‚Ä¢	Connected devices (best-effort)

run_audit(config: dict) -> dict

Pipeline:
	1.	Launch app
	2.	Optional onboarding/login seeding
	3.	Screen exploration
	4.	WCAG & a11y audits
	5.	VoiceOver evidence collection
	6.	Snapshot capture
	7.	Report generation
Returns summary + artifact paths.

run_diff(baseline_dir: str, candidate_dir: str, config: dict) -> dict

Produces:
	‚Ä¢	Accessibility tree diffs
	‚Ä¢	Screenshot diffs (heatmaps/masks)
	‚Ä¢	Regression summaries
Returns diff report paths.

MCP Entry

Must run:

python -m ios_wcag_accessibility_auditor.mcp_server


‚∏ª

4Ô∏è‚É£ iOS APP LAUNCH

Support:
	‚Ä¢	bundleId
	‚Ä¢	.app (simulator)
	‚Ä¢	.ipa (if environment allows; otherwise error clearly)

Capabilities must include:
	‚Ä¢	automationName = XCUITest
	‚Ä¢	deviceName, platformVersion, udid
	‚Ä¢	WDA stability options (timeouts, reuse, reset)
	‚Ä¢	Alert handling best-effort

‚∏ª

5Ô∏è‚É£ USER FLOW

Interactive
	‚Ä¢	Select simulator/device
	‚Ä¢	Choose app launch method
	‚Ä¢	Choose seeding strategy:
	‚Ä¢	Manual login (pause until READY)
	‚Ä¢	Seed steps JSON
	‚Ä¢	Deep link (optional)
	‚Ä¢	Configure exploration budgets
	‚Ä¢	Start audit

CI Mode
	‚Ä¢	Config-only
	‚Ä¢	Deterministic output directories
	‚Ä¢	Exit code based on severity threshold

‚∏ª

6Ô∏è‚É£ CONFIGURATION (config.yaml) ‚Äî MUST IMPLEMENT

Include full support for:
	‚Ä¢	Exploration limits
	‚Ä¢	Safety denylist
	‚Ä¢	WCAG thresholds
	‚Ä¢	Partial blind profiles
	‚Ä¢	Snapshot diffing
	‚Ä¢	VoiceOver evidence
	‚Ä¢	AI provider & privacy controls

Example config.yaml (must be supported)

appium_server_url: "http://127.0.0.1:4723"
run_name: "MyApp_iOS_WCAG_Audit"
output_dir: "./reports"

ios:
  target_kind: "simulator"          # simulator | device
  device_name: "iPhone 15"
  platform_version: "17.0"
  udid: "auto"
  launch:
    method: "bundle_id"             # bundle_id | app_path | ipa_path
    bundle_id: "com.example.app"
    app_path: ""                    # for .app
    ipa_path: ""                    # for .ipa
  session:
    no_reset: true
    full_reset: false
    new_command_timeout: 180
    wda_launch_timeout: 120000
    wda_connection_timeout: 120000
    use_new_wda: false

exploration:
  max_screens: 60
  max_depth: 10
  per_screen_action_budget: 35
  global_time_budget_minutes: 20
  allow_scroll: true
  allow_swipe: true
  avoid_text_input: true
  back_strategy_order: ["nav_back", "close_button", "swipe_back"]

safety:
  safe_mode: true
  denylist_keywords: ["delete","logout","pay","purchase","unsubscribe","cancel","remove"]
  allowlist_keywords: []
  risky_action_requires_confirm: false

audit:
  wcag_version: "2.2"
  levels: ["A", "AA"]
  include_best_practices: true
  rules:
    min_target_size_pt: 44
    duplicate_label_threshold: 2
    min_contrast_ratio_normal_text: 4.5
    min_contrast_ratio_large_text: 3.0
    min_non_text_contrast: 3.0
  severity_threshold_exit_code: "critical"   # none|minor|major|critical|blocker

partial_blind:
  enabled: true
  scenarios:
    - low_vision
    - color_vision_deficiency
    - reduced_contrast_sensitivity
    - magnification_user
    - large_text_user
  snapshot_profiles:
    - name: "default"
    - name: "large_text"
      notes: "Use accessibility text size profile if available; otherwise manual-precondition mode."
    - name: "high_contrast"
      notes: "Increase Contrast / Reduce Transparency if supported; else manual-precondition mode."
  manual_precondition_mode: true
  scoring:
    enabled: true
    weights:
      truncation_overlap: 3
      small_touch_targets: 3
      low_contrast: 4
      icon_only_controls: 2
      color_only_reliance: 2

diffing:
  enabled: true
  baseline_run_dir: ""                 # optional
  tree_diff_mode: "semantic"           # semantic | raw
  screenshot_diff:
    enabled: true
    threshold: 0.12
  ignore_dynamic_text_patterns:
    - "\\b\\d{1,2}:\\d{2}\\b"
    - "\\b\\d+\\b"

voiceover:
  enabled: true
  mode: "best_effort"                  # best_effort | manual_assist | metadata_only
  per_screen:
    capture_rotor_presence: true
    record_screen_reader_script: true
    capture_spoken_output: true
  rotor:
    expected_categories: ["Headings","Links","Form Controls"]
    strict: false
  scripts:
    max_steps_per_screen: 8
    include_back_navigation_step: true
    include_modal_dismiss_step: true
  capture:
    system_logs:
      enabled: true
      collect_duration_seconds: 4
    audio:
      enabled: false
      method: "simulator_loopback"     # simulator_loopback | external | none

ai:
  enabled: false
  provider: "openai"                   # openai | azure_openai | ollama | custom_http | none
  model: "gpt-4o-mini"
  timeout_seconds: 20
  max_retries: 2
  features:
    label_quality: true
    remediation_generation: true
    heuristic_explanations: true
    risk_ranking: true
  privacy:
    send_screenshots: false
    send_full_page_source: false
    send_element_metadata: true
    redact_sensitive_text: true

report:
  formats: ["json","html","pdf"]
  include_screenshots: true
  include_page_source: true
  include_bounding_boxes: true
  include_diff_section: true
  include_voiceover_section: true


‚∏ª

7Ô∏è‚É£ AUTOMATED SCREEN EXPLORATION

Implement a graph-based traversal engine:
	‚Ä¢	Stable screen fingerprinting (normalized XML + accessible elements signature)
	‚Ä¢	Loop detection
	‚Ä¢	Safe action prioritization (denylist/allowlist)
	‚Ä¢	Scroll handling with bounded steps
	‚Ä¢	Back navigation:
	‚Ä¢	Nav bar back
	‚Ä¢	Modal dismissal (Close/Done/Cancel)
	‚Ä¢	Swipe-back gesture best-effort

Capture per screen:
	‚Ä¢	Screenshot
	‚Ä¢	Page source XML
	‚Ä¢	Element inventory JSON (role/type, label/value/hint, traits, enabled, frame/bounds)

‚∏ª

8Ô∏è‚É£ WCAG + A11Y RULE ENGINE (MANDATORY)

Deterministic rules mapped to WCAG 2.2:
	‚Ä¢	Missing accessible name (4.1.2)
	‚Ä¢	Label in Name mismatch (best-effort) (2.5.3)
	‚Ä¢	Target size (2.5.8)
	‚Ä¢	Duplicate / ambiguous labels (2.4.6, 3.3.2)
	‚Ä¢	Focus order & traps (best-effort) (2.4.3, 2.1.2)
	‚Ä¢	Resize text / truncation (best-effort) (1.4.4, 1.4.10)
	‚Ä¢	Contrast (heuristic + confidence) (1.4.3, 1.4.11)
	‚Ä¢	Info & relationships (best-effort) (1.3.1)

Each finding includes:
	‚Ä¢	WCAG ID + level
	‚Ä¢	Severity (Blocker/Critical/Major/Minor)
	‚Ä¢	Confidence (1.0 deterministic; <1.0 heuristic/AI)
	‚Ä¢	Evidence paths (screenshot, XML, overlays)
	‚Ä¢	SwiftUI + UIKit fixes
	‚Ä¢	Verification steps (VoiceOver)

‚∏ª

9Ô∏è‚É£ PARTIAL BLIND ACCESSIBILITY MODULE

Analyze users with:
	‚Ä¢	Low vision
	‚Ä¢	Reduced contrast sensitivity
	‚Ä¢	Color vision deficiency
	‚Ä¢	Magnification usage
	‚Ä¢	Large text settings

Features:
	‚Ä¢	Multi-profile snapshots
	‚Ä¢	Truncation/overlap under large text
	‚Ä¢	Color-only reliance detection (heuristic)
	‚Ä¢	Small text / spacing risks (heuristic)
	‚Ä¢	Dedicated Partial Blind Accessibility Score (0‚Äì100)

Must clearly label which checks are deterministic vs heuristic.

‚∏ª

üîü SNAPSHOT-BASED UI DIFFING

Per screen snapshot:
	‚Ä¢	Screenshot
	‚Ä¢	XML page source
	‚Ä¢	Semantic accessibility snapshot JSON (normalized roles/names/bounds/states)

Diff engine:
	‚Ä¢	Tree diffs (labels, roles, exposure, state)
	‚Ä¢	Screenshot diffs (heatmaps/masks)
	‚Ä¢	Regression vs improvement classification
	‚Ä¢	Ignore dynamic content via regex patterns

Outputs:
	‚Ä¢	diff_report.json
	‚Ä¢	diff_report.html
	‚Ä¢	Diff images per changed screen

‚∏ª

1Ô∏è‚É£1Ô∏è‚É£ VOICEOVER EVIDENCE MODE (MANDATORY)

Implement VoiceOver Evidence Mode:

Capabilities:
	‚Ä¢	Screen reader scripts per screen
	‚Ä¢	Expected announcements (deterministic from metadata)
	‚Ä¢	Observed announcements (best-effort)
	‚Ä¢	Rotor presence checks:
	‚Ä¢	Metadata inference
	‚Ä¢	Log hints
	‚Ä¢	Manual-assist confirmation (when enabled)
	‚Ä¢	Spoken output capture placeholders
	‚Ä¢	Optional audio capture (opt-in)

Artifacts per screen:

voiceover/
  vo_script.json
  vo_script.md
  vo_expectations.json
  vo_observed.json
  vo_audio.m4a (optional)
  vo_logs.txt

Scripts must record:
	‚Ä¢	Focus navigation
	‚Ä¢	Activation
	‚Ä¢	Expected labels/roles/states
	‚Ä¢	Back/dismiss steps

Reports must include a per-screen ‚ÄúVoiceOver Evidence‚Äù section and clearly label evidence type:
	‚Ä¢	deterministic / observed / heuristic

‚∏ª

1Ô∏è‚É£2Ô∏è‚É£ OPTIONAL AI / LLM LAYER

AI must be:
	‚Ä¢	OFF by default
	‚Ä¢	Advisory only
	‚Ä¢	Auditable & privacy-controlled

AI use cases:
	‚Ä¢	Label quality evaluation (ambiguous vs meaningful)
	‚Ä¢	Remediation generation (SwiftUI/UIKit code)
	‚Ä¢	Heuristic explanation (contrast/focus/truncation)
	‚Ä¢	Risk ranking for exploration actions

AI outputs:
	‚Ä¢	Strict JSON only
	‚Ä¢	Confidence scores
	‚Ä¢	Clear labeling in reports
	‚Ä¢	Pydantic schema validation + fallback on failure

‚∏ª

1Ô∏è‚É£3Ô∏è‚É£ REPORTING

Generate:
	‚Ä¢	report.json
	‚Ä¢	report.html
	‚Ä¢	report.pdf (optional)
	‚Ä¢	scorecard.json
	‚Ä¢	partial_blind_scorecard.json
	‚Ä¢	diff_report.json/html (when diffing enabled)

HTML must include:
	‚Ä¢	Dashboard
	‚Ä¢	Per-screen issues
	‚Ä¢	WCAG filtering
	‚Ä¢	VoiceOver evidence sections
	‚Ä¢	Snapshot diff visualizations

‚∏ª

1Ô∏è‚É£4Ô∏è‚É£ DOCUMENTATION

Generate full docs:
	‚Ä¢	Getting started
	‚Ä¢	Configuration
	‚Ä¢	Exploration engine
	‚Ä¢	WCAG mapping
	‚Ä¢	Partial blind accessibility
	‚Ä¢	Snapshot diffing
	‚Ä¢	VoiceOver evidence
	‚Ä¢	AI & privacy
	‚Ä¢	CI integration
	‚Ä¢	Troubleshooting

‚∏ª

1Ô∏è‚É£5Ô∏è‚É£ REPOSITORY STRUCTURE

Produce complete repo:

ios_wcag_accessibility_auditor/
  README.md
  LICENSE
  pyproject.toml
  docs/
  examples/
  ios_wcag_accessibility_auditor/
    mcp_server.py
    cli.py
    drivers/
    explorer/
    audit/
    partial_blind/
    diffing/
    voiceover_evidence/
    ai/
    reports/
    utils/


‚∏ª

1Ô∏è‚É£6Ô∏è‚É£ ZIP PACKAGING (MANDATORY)

The final response MUST include:
	‚Ä¢	A single downloadable ZIP
	‚Ä¢	Full source code
	‚Ä¢	Docs
	‚Ä¢	Example configs
	‚Ä¢	Empty sample report folders
	‚Ä¢	Smoke-test config

Return Downloadable ZIP File

‚∏ª

1Ô∏è‚É£7Ô∏è‚É£ FINAL OUTPUT RULES
	‚Ä¢	Do NOT omit files
	‚Ä¢	Do NOT summarize
	‚Ä¢	Do NOT replace logic with descriptions
	‚Ä¢	Do NOT hide limitations
	‚Ä¢	Clearly mark AI & heuristic findings
